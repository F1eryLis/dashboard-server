datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                Int                @id @default(autoincrement())
  username          String             @unique
  password          String
  email             String             @unique
  userSubscriptions UserSubscription[]
}

model Subscription {
  id                  Int                  @id @default(autoincrement())
  term                String
  domain              String
  userSubscriptions   UserSubscription[]
  subscriptionModules SubscriptionModule[]
}

model Module {
  id                  Int                  @id @default(autoincrement())
  name                String
  styles              String?
  subscriptionModules SubscriptionModule[]
}

model UserSubscription {
  id             Int @id @default(autoincrement())
  userId         Int
  subscriptionId Int

  user         User         @relation(fields: [userId], references: [id])
  subscription Subscription @relation(fields: [subscriptionId], references: [id])

  @@unique([userId, subscriptionId])
}

model SubscriptionModule {
  id             Int @id @default(autoincrement())
  subscriptionId Int
  moduleId       Int

  subscription Subscription @relation(fields: [subscriptionId], references: [id])
  module       Module       @relation(fields: [moduleId], references: [id])

  @@unique([subscriptionId, moduleId])
}
